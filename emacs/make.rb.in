#!@@MHC_RUBY_PATH@@ -Ke
# -*- ruby -*-

$LOAD_PATH .unshift('@@MHC_TOPDIR@@')

OPT = ''
OPT += '--with-lispdir=@@MHC_LISPDIR@@' if '@@MHC_LISPDIR@@' != ''
OPT += '--with-packagedir=@@MHC_XEMACS_PACKAGE_DIR@@' if '@@MHC_XEMACS_PACKAGE_DIR@@' != ''
OPT += '--with-addpath=@@MHC_EMACS_ADD_PATH@@' if '@@MHC_EMACS_ADD_PATH@@' != ''
OPT += '--with-mew=@@MHC_WITH_MEW@@' if '@@MHC_WITH_MEW@@' != ''
OPT += '--with-wl=@@MHC_WITH_WL@@' if '@@MHC_WITH_WL@@' != ''
OPT += '--with-gnus=@@MHC_WITH_GNUS@@' if '@@MHC_WITH_GNUS@@' != ''
OPT += '--with-gnus=@@MHC_WITH_CMAIL@@' if '@@MHC_WITH_CMAIL@@' != ''

require 'mhc-make'
include MhcMake

EMACS  = '@@MHC_EMACS_PATH@@'
XEMACS = '@@MHC_XEMACS_PATH@@'
OPTION = '-batch -q -no-site-file -l MHC-MK'

def default
  make_system("#{EMACS} #{OPTION} -f make-mhc-compile")
end

def package
  make_system("#{XEMACS} #{OPTION} -f make-mhc-compile-package")
end

def clean
  Dir .glob("*.elc auto-autoloads.el custom-load.el make.rb") .each{|file|
    print "removing: " + file + "\n"
    File .delete(file)
  }
end

def install
  make_system("#{EMACS} #{OPTION} -f make-mhc-install")
end

doit()
